<!DOCTYPE html>
<html>
<head>
    <title>Treinamento ITIL V4</title>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" type="text/css" href="styles.css" /> 
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script>
        let respostasCorretas = [];
        let respostasSelecionadas = [];

        function embaralharConteudo() {
            const perguntas = [
                {
                    texto: "O que é ITIL 4?",
                    respostas: [
                        "Um Framework para desenvolvimento de software.",
                        "Uma abordagem para gerenciamento de serviços de TI que se concentra na co-criação de um valor.",
                        "Um padrão de segurança da informação.",
                        "Um processo de melhoria contínua."
                    ],
                    correta: 1 
                },
                {
                    texto: "Qual dos seguintes componentes NÃO faz parte do itil v4?",
                    respostas: [
                        "Gerenciamento de incidentes",
                        "Gerenciamento de produto",
                        "Gerenciamento de problemas",
                        "Gerenciamento de mudanças"
                    ],
                    correta: 1
                },
                {
                    texto: "O que é o modelo de quatro dimensões do itil?",
                    respostas: [
                        "Um modelo de avaliação de desempenho",
                        "Um framework de desenvovimento ágil",
                        "Um conjunto de quatro áreas que devem ser consideradas na gestão de serviços",
                        "Um método de gerenciamento do projetos"
                    ],
                    correta: 2
                },
                {
                    texto: "Qual das seguintes práticas é parte do ITIL v4?",
                    respostas: [
                        "Planejamento estratégico",
                        "Gestão de mudança",
                        "Gestão de recursos humanos",
                        "Gestão financeira"
                    ],
                    correta: 1
                },
                {
                    texto: "Qual dos seguintes é um dos princípios fundamentais do itil v4?",
                    respostas: [
                        "Maximizar custo",
                        "Foco no valor",
                        "Restringir mudanças",
                        "Centralizar a tomada de decições"
                    ],
                    correta: 1
                },
                {
                    texto: "Qual pratica é responsável por implementar componentes em ambientes de produção?",
                    respostas: [
                        "Habilitação de mudança",
                        "Gerenciamento de liberação",
                        "Gerenciamento de ativos de TI",
                        "Gerenciamento de implantação"
                    ],
                    correta: 3
                },
                {
                    texto: "Qual pratica abrange a classificação e a propriedade de consultas e requisições dos usuários?",
                    respostas: [
                        "Central de serviços",
                        "Gerencimento de incidente",
                        "Habilitação de mudança",
                        "Gerenciamento de nível de serviço"
                    ],
                    correta: 0
                },
                {
                    texto: "Qual prática identifica métricas que refletem a experiência do cliente em um serviço?",
                    respostas: [
                        "Melhoria contínua",
                        "Central de serviços",
                        "Gerenciamento de nível de serviço",
                        "Gerenciamento de problema"
                    ],
                    correta: 2
                },
                {
                    texto: "Qual é principal uso de um calendário de mudanças?",
                    respostas: [
                        "Suportar o 'gerenciamento de incidente' e o planejamento da melhoria",
                        "Gerenciar mudanças emergenciais",
                        "Planejar mudanças e ajudar a evitar conflitos",
                        "Gerenciar mudanças padrão"
                    ],
                    correta: 2
                },
                {
                    texto: "Qual dimensão do gerenciamento de serviço se concentra nas atividades e em como elas são coordenadas?",
                    respostas: [
                        "Organização e pessoas",
                        "Informação e tecnologia",
                        "Parceiros e fornecedores",
                        "Fluxos de valor e processos"
                    ],
                    correta: 3
                },
                {
                    texto: "O que significa 'Começar onde você está' no contexto do ITIL v4?",
                    respostas: [
                        "Implementar novas ferramentas sem considerar o que já existe",
                        "Avaliar a situação atual antes de fazer mudanças",
                        "Iniciar o projeto em um local específico",
                        "Ignorar processo existentes"
                    ],
                    correta: 1
                },
                {
                    texto: "Qual é o principal objetivo da prática de gerenciamento de incidentes?",
                    respostas: [
                        "Restaurar a operação normal do serviço o mais rápido possível",
                        "Identificar a causa raiz de um problema",
                        "Aumentar a eficiência do pessoal",
                        "Documento todo os serviços oferecidos"
                    ],
                    correta: 0
                },
                {
                    texto: "O que é um 'fluxo de valor' no ITIL v4?",
                    respostas: [
                        "Uma sequência de etapas que cria um produto final",
                        "Um conjunto de ferramentas utilizadas na gestão de serviços",
                        "Um relatório financeiro sobre serviços",
                        "Uma análise de mercado para novos serviços"
                    ],
                    correta: 0
                },
                {
                    texto: "Qual das seguintes opções melhor descreve a prática de gerenciamento de mudanças?",
                    respostas: [
                        "Proteger a infraestrutura de TI contra falhas",
                        "Controlar alterações em serviços de TI de forma eficiente e minimizando riscos",
                        "Criar novos serviços para atender às demandas do cliente",
                        "Avaliar a satisfação do cliente com os serviços existentes"
                    ],
                    correta: 1
                },
                {
                    texto: "O que é 'pensar e trabalhar de forma holística' no ITIL v4 ?",
                    respostas: [
                        "Focar apenas nas equipes técnicas",
                        "Considerar todos os aspectos de um serviço e suas interações",
                        "Utilizar apenas dados quantitativos para avaliação",
                        "Separar o gerencimento de serviços de outras áreas da organização"
                    ],
                    correta: 1
                },
                {
                    texto: "Qual é o objetivo da prática de gerenciamento de problemas?",
                    respostas: [
                        "Prover suporte técnico ao usuário final",
                        "Identificar e eliminar causas de incidentes para evitar recorrências",
                        "Controlar as mudanças nos serviços de TI",
                        "Monitorar a performance de serviços em tempo real"
                    ],
                    correta: 1
                }
            ];

            // Embaralha as perguntas
            perguntas.sort(() => Math.random() - 0.5);

            perguntas.forEach(function(pergunta, index) {
                const respostas = pergunta.respostas.slice(); // Cria uma cópia para embaralhar
                const correta = pergunta.correta;
                respostas.sort(() => Math.random() - 0.5); // Embaralha as respostas aleatoriamente

                // Armazena a posição da resposta correta após o embaralhamento
                const respostaCorretaEmbaralhada = respostas.indexOf(pergunta.respostas[correta]);
                respostasCorretas.push(respostaCorretaEmbaralhada);

                // Seleciona o campo para inserir a pergunta e as respostas
                const divPergunta = document.createElement('fieldset');
                const legenda = document.createElement('legend');
                legenda.innerHTML = `<strong>Pergunta ${index + 1}:</strong> ${pergunta.texto}`;
                divPergunta.appendChild(legenda);

                // Atribui as respostas embaralhadas aos elementos
                respostas.forEach((resposta, i) => {
                    const label = document.createElement('label');
                    label.classList.add('resposta');
                    label.innerHTML = `<input type="radio" name="pergunta${index + 1}" value="${i}"> ${resposta}`;
                    divPergunta.appendChild(label);
                    divPergunta.appendChild(document.createElement('br')); // Quebra de linha
                });

                // Adiciona o conjunto de perguntas à página
                document.querySelector('.content').appendChild(divPergunta);
            });
        }

        function verificarRespostas() {
            let acertos = 0;
            let erros = 0;

            if (window.confirm("Confirma envio das respostas?") === true) {
                // Verifica as respostas selecionadas
                respostasCorretas.forEach((respostaCorreta, index) => {
                    const respostaSelecionada = document.querySelector(`input[name="pergunta${index + 1}"]:checked`);

                    if (respostaSelecionada) {
                        const valorSelecionado = parseInt(respostaSelecionada.value);
                        respostasSelecionadas.push(valorSelecionado);

                        if (valorSelecionado === respostaCorreta) {
                            acertos++;
                        } else {
                            erros++;
                        }
                    } else {
                        erros++; // Se não houver resposta, conta como erro
                    }
                });

                // Envia as respostas via fetch
                enviarResultados(acertos, erros);
            } 
        }

        function mostrarDiv() {
            var div = document.getElementById('Resp');
            div.style.display = 'block';
        }

        function enviarResultados(acertos, erros) {
            // Dados para enviar via fetch
            const dados = {
                acertos: acertos,
                erros: erros
            };

            // Envia para o servidor ( endpoint fictício, pode ser alterado conforme necessário)
            fetch('https://jsonplaceholder.typicode.com/posts', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify(dados)
            })
            .then(response => response.json())
            .then(data => {
                console.log('Resposta do servidor:', data);
                alert("Resultado enviado com sucesso!");
                
                //mostra div grafico oculta
                mostrarDiv();
                // Após enviar, exibe o gráfico com os resultados
                exibirGrafico(acertos, erros);

            })
            .catch(error => {
                console.error('Erro ao enviar os dados:', error);
                alert("Erro ao enviar os dados.");
            });
        }

        function exibirGrafico(acertos, erros) {
            const ctx = document.getElementById('grafico').getContext('2d');

            new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: ['Acertos', 'Erros'],
                    datasets: [{
                        label: '',
                        data: [acertos, erros],
                        backgroundColor: ['#4caf50', '#f44336'],
                        borderColor: ['#388e3c', '#d32f2f'],
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: {
                                stepSize: 1
                            }
                        }
                    }
                }
            });
        }
    </script>
</head>
<body onload="embaralharConteudo()">
    <div class="content">
        <h1>Treinamento simulado ITIL V4</h1>
    </div>
    <div>
        <button onclick="window.location.reload()">Limpar Respostas</button> 
        <button onclick="verificarRespostas()">Enviar Respostas</button>
    </div>
    <div id="Resp" hidden>
         <h2>Resultados</h2>
         <canvas id="grafico" width="200" height="200"></canvas>
    </div>
    <footer>
        <p>&#169; copyright 2024 Desenvolvido por Marcio M. Araujo</p>
    </footer>
</body>
</html>
